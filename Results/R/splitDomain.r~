splitDomain <- function(x, y, A, spliter, N, imageName){
    source("split.r")
    plot(x,y,
         xlim=c(0,1),
         ylim=c(0,1),
         col=color_p+1, #type="p", 
         pch = 19, 
         cex = 0.6, 
         xlab=NA, 
         ylab=NA, 
         axes=F, #xaxt="n", #yaxt="n", #frame.plot="TRUE", #bty="n"
         );box()

    subRegions = list(A)
    subSetX = list(x)
    subSetY = list(y)

    for (i in 1:N){
        # Obtaining the most populated region
        M = subRegions[1]
        R = 1;
        if(length(subRegions) > 1){
            for(j in 2:length(subRegions)){
                if(length(subSetX[[j]]) > length(subSetX[[R]])){
                    R = j;
                }
            }
        }
    
        # Take the most populated sub set
        M = subRegions[[R]]
        MX = subSetX[[R]]
        MY = subSetY[[R]]

        # remove it from the list
        subRegions[R] = NULL 
        subSetX[R] = NULL 
        subSetY[R] = NULL     

        # split the sub set
        A1A2 = split(M, MX, MY, spliter)

        # add the 2 new sub sets to the list
        subRegions[[i]] = A1A2[[1]]$area; subRegions[[i+1]] =  A1A2[[2]]$area
        subSetX[[i]] = A1A2[[1]]$X; subSetX[[i+1]] = A1A2[[2]]$X
        subSetY[[i]] = A1A2[[1]]$Y; subSetY[[i+1]] = A1A2[[2]]$Y
    }

    # label the regions with the number of clients
    for(k in 1:length(subRegions)){
        x.t = mean(subRegions[[k]][1,])
        y.t = mean(subRegions[[k]][2,])
        nrClients = length(subSetX[[k]])
        text(x.t, y.t,nrClients, col="blue")
    }

    dev.copy2pdf(file=imageName)
}
